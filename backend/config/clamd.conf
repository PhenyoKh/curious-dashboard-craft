# ClamAV Daemon Configuration
# This file configures the ClamAV daemon for optimal security and performance

# Remove comment from the line below to enable clamd
# Example

##
## Main options
##

# Path to a local socket file the daemon will listen on
LocalSocket /var/run/clamav/clamd.ctl

# Sets the group ownership on the unix socket
LocalSocketGroup clamav

# Remove group write permissions from the unix socket
LocalSocketMode 666

# Close the UNIX socket and listen on a TCP socket
TCPSocket 3310

# TCP address to listen on (default: any address)
TCPAddr 127.0.0.1

# Maximum length the queue of pending connections may grow to
MaxConnectionQueueLength 30

# Path to the database directory
DatabaseDirectory /var/lib/clamav

# Only load the official signatures published by the ClamAV project
OfficialDatabaseOnly no

# The daemon will log all scanned files
LogFile /var/log/clamav/clamav.log

# Log additional information about the infected files
LogVerbose yes

# Enable log rotation
LogRotate yes

# Log file size limit
LogFileMaxSize 100M

# Use system logger
LogSyslog yes

# Specify the type of syslog messages
LogFacility LOG_LOCAL6

# Enable logging of clean files
LogClean no

# This option allows you to save a process identifier of the listening
# daemon to a specified file
PidFile /var/run/clamav/clamd.pid

# Define a temporary directory for ClamAV
TemporaryDirectory /tmp

# This option allows you to change the default database directory
DatabaseDirectory /var/lib/clamav

# Maximum number of files to be scanned within an archive
MaxFiles 10000

# The maximum size of a file to be scanned
MaxFileSize 100M

# Files larger than this limit won't be scanned
StreamMaxLength 100M

# Maximum size of HWP3 file to be scanned
MaxHWP3FileSize 100M

# Maximum size of PDF file to be scanned  
MaxPDFFileSize 100M

# Maximum size of HTML file to be scanned
MaxHTMLFileSize 100M

# Maximum size of RTF file to be scanned
MaxRTFFileSize 100M

# Maximum size of MS Office document to be scanned
MaxOLEFileSize 100M

# Maximum recursion level for archives
MaxRecursion 10

# Maximum compression ratio for archives  
MaxCompressionRatio 500

# Scan archives
ScanArchive yes

# Scan RAR archives
ScanRAR yes

# Scan ZIP archives  
ScanZIP yes

# Scan Gzip archives
ScanGzip yes

# Scan Bzip2 archives
ScanBzip2 yes

# Scan 7Zip archives
ScanSeven yes

# Scan TAR archives
ScanTAR yes

# Scan ARJ archives
ScanARJ yes

# Scan CAB archives
ScanCAB yes

# Scan LHA archives
ScanLHA yes

# Scan Microsoft CHM files
ScanCHM yes

# Scan SIS files
ScanSIS yes

# Scan HTML files
ScanHTML yes

# Scan RTF files
ScanRTF yes

# Scan PDF files
ScanPDF yes

# Scan MS OLE2 files
ScanOLE2 yes

# Scan PE files
ScanPE yes

# Scan ELF files
ScanELF yes

# Scan Mach-O files for macOS
ScanMachO yes

# Enable heuristic scanning
HeuristicScanPrecedence yes

# Enable structured data detection
StructuredDataDetection yes

# Enable phishing signatures
PhishingSignatures yes

# Enable phishing scan URLs
PhishingScanURLs yes

# Enable phishing always block SSL mismatch
PhishingAlwaysBlockSSLMismatch yes

# Enable phishing always block cloak
PhishingAlwaysBlockCloak yes

# Enable partition intersection detection
PartitionIntersection yes

# Detect broken executables
DetectBrokenExecutables yes

# Exit on out of memory
ExitOnOOM yes

# Leave temporary files for debugging
LeaveTemporaryFiles no

# Perform a database check
SelfCheck 600

# Disable submission of statistics
DisableCertCheck yes

# Algorithm to check integrity of Bytecode
BytecodeSecurityV 3

# Set bytecode timeout
BytecodeTimeout 10000

# Maximum number of partitions in raw disk image to be scanned
MaxPartitions 128

# Maximum number of icons in PE file to be scanned
MaxIconsPE 200

# Maximum number of embedded PE files
MaxEmbeddedPE 40

# Maximum size of HTML normalize
MaxHTMLNormalize 10M

# Maximum size of script file to be normalized
MaxScriptNormalize 5M

# Maximum size of a ZIP file to be normalized
MaxZipTypeRcg 1M

# This option sets the maximum calls to HWP3 parsing function
MaxHWP3ParsingPages 100