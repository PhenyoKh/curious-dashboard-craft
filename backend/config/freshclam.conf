# FreshClam Configuration
# This file configures automatic virus signature database updates

# Remove comment from the line below to enable freshclam
# Example

##
## Update options
##

# Path to the database directory
DatabaseDirectory /var/lib/clamav

# Path to the log file (make sure the directory is writable by clamav user)
UpdateLogFile /var/log/clamav/freshclam.log

# Enable verbose logging
LogVerbose yes

# Enable logging to system log
LogSyslog yes

# Specify the type of syslog messages
LogFacility LOG_LOCAL6

# Enable log rotation
LogRotate yes

# Maximum size of log file
LogFileMaxSize 50M

# This option allows you to save the process identifier of the daemon
PidFile /var/run/clamav/freshclam.pid

# By default when started freshclam drops privileges and switches to the "clamav" user
DatabaseOwner clamav

# Use DNS to verify virus database version
DNSDatabaseInfo current.cvd.clamav.net

# Download database from ClamAV official mirrors
DatabaseMirror db.local.clamav.net
DatabaseMirror database.clamav.net

# Number of database checks per day
Checks 12

# Proxy settings (uncomment if needed)
# HTTPProxyServer myproxy.com
# HTTPProxyPort 1234
# HTTPProxyUsername myusername
# HTTPProxyPassword mypassword

# Local HTTP server settings (uncomment if needed)
# LocalIPAddress aaa.bbb.ccc.ddd

# Send the RELOAD command to clamd after successful database update
NotifyClamd /etc/clamav/clamd.conf

# Run command after successful database update
OnUpdateExecute /bin/systemctl reload clamav-daemon

# Run command on database update error  
OnErrorExecute /bin/systemctl restart clamav-freshclam

# Run command on outdated signature detection
OnOutdatedExecute /usr/bin/logger "ClamAV database is outdated"

# Connect timeout in seconds
ConnectTimeout 60

# Data read timeout in seconds  
ReceiveTimeout 60

# Enable test databases (for testing environments)
TestDatabases no

# Script timeout in seconds
ScriptedUpdates yes

# Enable compression for database downloads
CompressLocalDatabase no

# Bytecode security level
BytecodeSecurityV 3

# Submit detection stats
SubmitDetectionStats no

# Detection stats country
DetectionStatsCountry country-code

# Detection stats hostname  
DetectionStatsHostID auto

# Enable SafeBrowsing
SafeBrowsing yes

# Enable suspicious cert alert
Bytecode yes

# Enable extra detection
ExtraDetection yes

# Maximum attempts to download database
MaxAttempts 5

# Exclude specific database signatures (if needed)
# ExcludeDatabase win.hdb

# Include additional signature databases
# Include additional-sigs.hdb